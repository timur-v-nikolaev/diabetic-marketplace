# üîê –û—Ç—á—ë—Ç –æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ ‚Äî –î–∏–∞–±–µ—Ç–ú–∞—Ä–∫–µ—Ç

## –î–∞—Ç–∞ –∞—É–¥–∏—Ç–∞: 12 —è–Ω–≤–∞—Ä—è 2026

---

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏

### 1. üî¥ –£–¥–∞–ª—ë–Ω –æ–ø–∞—Å–Ω—ã–π endpoint `/api/admin/make-admin`
**–†–∏—Å–∫:** –õ—é–±–æ–π –º–æ–≥ —Å–¥–µ–ª–∞—Ç—å —Å–µ–±—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º, –∑–Ω–∞—è –ø—Ä–æ—Å—Ç–æ–π —Å–µ–∫—Ä–µ—Ç
**–†–µ—à–µ–Ω–∏–µ:** Endpoint –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª—ë–Ω –∏–∑ routes

### 2. üî¥ NoSQL Injection —á–µ—Ä–µ–∑ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ ObjectId
**–†–∏—Å–∫:** –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–≥ –≤—ã–∑–≤–∞—Ç—å –æ—à–∏–±–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞ –∏–ª–∏ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º
**–†–µ—à–µ–Ω–∏–µ:** 
- –î–æ–±–∞–≤–ª–µ–Ω `validateObjectId()` middleware
- –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `:id`, `:userId`, `:notificationId` —Ç–µ–ø–µ—Ä—å –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è

### 3. üî¥ XSS —á–µ—Ä–µ–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥
**–†–∏—Å–∫:** –ò–Ω—ä–µ–∫—Ü–∏—è –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤ —á–µ—Ä–µ–∑ title, description –∏ –¥—Ä—É–≥–∏–µ –ø–æ–ª—è
**–†–µ—à–µ–Ω–∏–µ:**
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω `sanitize-html`
- –í—Å–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –ø–æ–ª—è —Å–∞–Ω–∏—Ç–∏–∑–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ `sanitizeText()`
- –î–æ–±–∞–≤–ª–µ–Ω—ã –≤–∞–ª–∏–¥–∞—Ç–æ—Ä—ã: `validateCreateListing`, `validateUpdateProfile`, `validateMessage`

### 4. üî¥ –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
**–†–∏—Å–∫:** –õ—é–±–æ–π –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–≥ –æ–¥–æ–±—Ä—è—Ç—å/–æ—Ç–∫–ª–æ–Ω—è—Ç—å –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é
**–†–µ—à–µ–Ω–∏–µ:**
- –°–æ–∑–¥–∞–Ω `adminMiddleware`
- –ó–∞—â–∏—â–µ–Ω—ã endpoints: `/verification/pending`, `/verification/approve`, `/verification/reject`

---

## ‚úÖ –£—Å–∏–ª–µ–Ω–Ω–∞—è –∑–∞—â–∏—Ç–∞

### 5. üü° –£–ª—É—á—à–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è CORS
**–ë—ã–ª–æ:** `origin: '*'` ‚Äî –ª—é–±–æ–π –¥–æ–º–µ–Ω –º–æ–≥ –¥–µ–ª–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã
**–°—Ç–∞–ª–æ:**
```javascript
const allowedOrigins = [
  'http://localhost:3000',
  'http://localhost:3001',
  process.env.FRONTEND_URL,
];
// + –¥–æ–º–µ–Ω—ã *.trycloudflare.com –∏ *.vercel.app
```

### 6. üü° –î–æ–±–∞–≤–ª–µ–Ω Content Security Policy
```javascript
contentSecurityPolicy: {
  defaultSrc: ["'self'"],
  scriptSrc: ["'self'"],
  imgSrc: ["'self'", "data:", "blob:", "https:"],
  frameSrc: ["'none'"],
  objectSrc: ["'none'"],
}
```

### 7. üü° Rate Limiting
- **–û–±—â–∏–π:** 100 –∑–∞–ø—Ä–æ—Å–æ–≤ / 15 –º–∏–Ω—É—Ç
- **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:** 5 –ø–æ–ø—ã—Ç–æ–∫ / 15 –º–∏–Ω—É—Ç
- Health check endpoints –∏—Å–∫–ª—é—á–µ–Ω—ã –∏–∑ –ª–∏–º–∏—Ç–æ–≤

### 8. üü° –í–∞–ª–∏–¥–∞—Ü–∏—è query –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
```javascript
// –¢–µ–ø–µ—Ä—å –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è:
- page: 1-1000
- limit: 1-100  
- minPrice/maxPrice: >= 0
- search: max 100 —Å–∏–º–≤–æ–ª–æ–≤
```

---

## üìÇ –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã

| –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------|------------|
| `middleware/validation.ts` | –í–∞–ª–∏–¥–∞—Ç–æ—Ä—ã –∏ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è |
| `middleware/admin.ts` | –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ |

---

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

| –ü–∞–∫–µ—Ç | –í–µ—Ä—Å–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-------|--------|------------|
| `sanitize-html` | latest | –ó–∞—â–∏—Ç–∞ –æ—Ç XSS |
| `express-mongo-sanitize` | ^2.2.0 | –ó–∞—â–∏—Ç–∞ –æ—Ç NoSQL injection |
| `express-validator` | ^7.0.0 | –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö |
| `helmet` | latest | HTTP security headers |
| `express-rate-limit` | latest | –ó–∞—â–∏—Ç–∞ –æ—Ç DDoS/brute-force |

---

## üîí –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

### ‚ö†Ô∏è –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û:

1. **–°–º–µ–Ω–∏—Ç—å JWT_SECRET** –Ω–∞ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Å—Ç–æ–π–∫–∏–π –∫–ª—é—á:
   ```bash
   node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
   ```

2. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å HTTPS** ‚Äî —Ç–µ–∫—É—â–∏–π HTTP –Ω–µ–±–µ–∑–æ–ø–∞—Å–µ–Ω

3. **–°–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å MongoDB** ‚Äî `password` –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

4. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** ‚Äî –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

### üéØ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:

- –î–æ–±–∞–≤–∏—Ç—å 2FA –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å backup –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –î–æ–±–∞–≤–∏—Ç—å WAF (Web Application Firewall)
- –ü—Ä–æ–≤–µ—Å—Ç–∏ penetration testing

---

## ‚úÖ –°—Ç–∞—Ç—É—Å

| –ú–µ—Ç—Ä–∏–∫–∞ | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|---------|-----------|
| –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ | 0 |
| npm audit (backend) | 0 —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π |
| npm audit (frontend) | 0 —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π |
| –°–µ—Ä–≤–µ—Ä | –†–∞–±–æ—Ç–∞–µ—Ç |
| API Health | ‚úÖ OK |

---

*–û—Ç—á—ë—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏*
