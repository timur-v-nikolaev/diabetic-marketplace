# Telegram Mini App - –î–∏–∞–±–µ—Ç –ú–∞—Ä–∫–µ—Ç

## –û–ø–∏—Å–∞–Ω–∏–µ

Telegram Mini App –¥–ª—è –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞ –¥–∏–∞–±–µ—Ç–∏—á–µ—Å–∫–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤. –ü–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º:

- üõçÔ∏è –ü–æ–∫—É–ø–∞—Ç—å –∏ –ø—Ä–æ–¥–∞–≤–∞—Ç—å –¥–∏–∞–±–µ—Ç–∏—á–µ—Å–∫–∏–µ —Ç–æ–≤–∞—Ä—ã
- üë§ –£–ø—Ä–∞–≤–ª—è—Ç—å –ª–∏—á–Ω—ã–º –∫–∞–±–∏–Ω–µ—Ç–æ–º
- ‚ù§Ô∏è –î–æ–±–∞–≤–ª—è—Ç—å —Ç–æ–≤–∞—Ä—ã –∏ –ø—Ä–æ–¥–∞–≤—Ü–æ–≤ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
- üîç –ò—Å–∫–∞—Ç—å —Ç–æ–≤–∞—Ä—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
- üí¨ –û–±—â–∞—Ç—å—Å—è —Å –ø—Ä–æ–¥–∞–≤—Ü–∞–º–∏

## –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤

- ü©∏ –ì–ª—é–∫–æ–º–µ—Ç—Ä—ã
- üìè –¢–µ—Å—Ç-–ø–æ–ª–æ—Å–∫–∏
- üíâ –ò–Ω—Å—É–ª–∏–Ω
- ‚úèÔ∏è –®–ø—Ä–∏—Ü-—Ä—É—á–∫–∏
- üìç –ò–≥–ª—ã
- ‚öôÔ∏è –ò–Ω—Å—É–ª–∏–Ω–æ–≤—ã–µ –ø–æ–º–ø—ã
- üì° –°–µ–Ω—Å–æ—Ä—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (CGM)
- üî∏ –õ–∞–Ω—Ü–µ—Ç—ã
- üëú –ß–µ—Ö–ª—ã –∏ –∞–∫—Å–µ—Å—Å—É–∞—Ä—ã
- ü•ó –î–∏–∞–±–µ—Ç–∏—á–µ—Å–∫–æ–µ –ø–∏—Ç–∞–Ω–∏–µ
- üìö –ö–Ω–∏–≥–∏ –∏ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞
- üì¶ –î—Ä—É–≥–æ–µ

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–æ—Ç–∞

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –±–æ—Ç–∞ –≤ BotFather

1. –û—Ç–∫—Ä–æ–π—Ç–µ [@BotFather](https://t.me/botfather) –≤ Telegram
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/newbot`
3. –í–≤–µ–¥–∏—Ç–µ –∏–º—è –±–æ—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: "–î–∏–∞–±–µ—Ç –ú–∞—Ä–∫–µ—Ç")
4. –í–≤–µ–¥–∏—Ç–µ username –±–æ—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `diabetic_market_bot`)
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Mini App

1. –í BotFather –æ—Ç–ø—Ä–∞–≤—å—Ç–µ `/mybots`
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
3. –ù–∞–∂–º–∏—Ç–µ "Bot Settings" ‚Üí "Menu Button" ‚Üí "Configure menu button"
4. –í–≤–µ–¥–∏—Ç–µ URL –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä: `https://your-app.vercel.app/tg`)
5. –í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä: "üõçÔ∏è –ú–∞—Ä–∫–µ—Ç")

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Web App

1. –í BotFather –æ—Ç–ø—Ä–∞–≤—å—Ç–µ `/mybots`
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
3. –ù–∞–∂–º–∏—Ç–µ "Bot Settings" ‚Üí "Domain" ‚Üí "Add Domain"
4. –î–æ–±–∞–≤—å—Ç–µ –¥–æ–º–µ–Ω –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### Backend (.env)

```env
# Telegram Bot
TELEGRAM_BOT_TOKEN=your_bot_token_here

# MongoDB
MONGODB_URI=mongodb://localhost:27017/diabetic-marketplace

# JWT
JWT_SECRET=your_jwt_secret_here
JWT_EXPIRES_IN=7d

# Server
PORT=5001
```

### Frontend (.env.local)

```env
NEXT_PUBLIC_API_URL=http://localhost:5001/api
```

## –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```bash
# Backend
cd backend
npm install
npm run dev

# Frontend
cd frontend
npm install
npm run dev
```

### –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π

```bash
cd scripts
npx ts-node seed-categories.ts
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å—Ç—Ä–∞–Ω–∏—Ü Telegram Mini App

```
/tg                     - –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (–∫–∞—Ç–∞–ª–æ–≥)
/tg/cabinet             - –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç
/tg/categories          - –í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
/tg/create              - –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
/tg/listings/[id]       - –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç–æ–≤–∞—Ä–∞
/tg/sellers/[id]        - –ü—Ä–æ—Ñ–∏–ª—å –ø—Ä–æ–¥–∞–≤—Ü–∞
/tg/messages            - –°–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤
/tg/messages/[id]       - –ß–∞—Ç —Å –ø—Ä–æ–¥–∞–≤—Ü–æ–º
```

## API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

### Telegram –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

- `POST /api/auth/telegram` - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram initData
- `POST /api/auth/telegram/complete-profile` - –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- `GET /api/auth/telegram/profile` - –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è

### –ò–∑–±—Ä–∞–Ω–Ω–æ–µ

- `POST /api/favorites/listings/:listingId` - –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
- `DELETE /api/favorites/listings/:listingId` - –£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
- `GET /api/favorites/listings` - –ü–æ–ª—É—á–∏—Ç—å –∏–∑–±—Ä–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã
- `POST /api/favorites/sellers/:sellerId` - –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –ø—Ä–æ–¥–∞–≤—Ü–∞
- `DELETE /api/favorites/sellers/:sellerId` - –û—Ç–ø–∏—Å–∞—Ç—å—Å—è –æ—Ç –ø—Ä–æ–¥–∞–≤—Ü–∞
- `GET /api/favorites/sellers` - –ü–æ–ª—É—á–∏—Ç—å –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –ø—Ä–æ–¥–∞–≤—Ü–æ–≤

### –ö–∞—Ç–µ–≥–æ—Ä–∏–∏

- `GET /api/categories` - –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### Telegram WebApp SDK

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç [Telegram WebApp SDK](https://core.telegram.org/bots/webapps) –¥–ª—è:

- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- Haptic feedback
- –ö–Ω–æ–ø–æ–∫ Back –∏ Main
- –ú–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω (Alert, Confirm)
- –¢–µ–º–∏–∑–∞—Ü–∏–∏

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

–ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ Mini App –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ Telegram. –ï—Å–ª–∏ —ç—Ç–æ –ø–µ—Ä–≤—ã–π –≤—Ö–æ–¥, –µ–º—É –±—É–¥–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–æ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å (—Ç–µ–ª–µ—Ñ–æ–Ω –∏ –≥–æ—Ä–æ–¥).

### –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω

UI –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ —Å —É—á—ë—Ç–æ–º:

- Safe area insets
- Touch-friendly —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- –ö–æ–º–ø–∞–∫—Ç–Ω–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∞–Ω–∏–º–∞—Ü–∏–π

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –í–∞–ª–∏–¥–∞—Ü–∏—è initData

–ë—ç–∫–µ–Ω–¥ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç `initData` –æ—Ç Telegram:

1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å—å (hash) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ç–æ–∫–µ–Ω–∞ –±–æ—Ç–∞
2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Ä–µ–º—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (–Ω–µ —Å—Ç–∞—Ä—à–µ 1 —á–∞—Å–∞)
3. –ò–∑–≤–ª–µ–∫–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### JWT —Ç–æ–∫–µ–Ω—ã

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤—ã–¥–∞—ë—Ç—Å—è JWT —Ç–æ–∫–µ–Ω –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.

## –î–µ–ø–ª–æ–π

### Vercel (Frontend)

1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∫ Vercel
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
3. –î–µ–ø–ª–æ–π –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º

### Railway/Render (Backend)

1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
3. –£–∫–∞–∂–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –∑–∞–ø—É—Å–∫–∞: `npm run build && npm start`

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã, —Å–æ–∑–¥–∞–π—Ç–µ issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.
